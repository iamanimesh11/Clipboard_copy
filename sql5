ğŸ’¥ Buckle up â€” here comes your next SQL challenge, and itâ€™s a real-world scenario companies like Amazon, Flipkart, or Meesho face every day:


---

ğŸ§  Business Case: Repeat Product Buyers

> Youâ€™re working with the product team to identify which users are most loyal to specific products. They want to see whoâ€™s buying the same product again and again â€” this helps in personalized marketing and restock predictions.




---

ğŸ—‚ï¸ Table: user_orders

order_id	user_id	product_id	order_date	price

101	U1	P1	2024-06-01	500
102	U1	P2	2024-06-02	800
103	U1	P1	2024-06-05	500
104	U2	P3	2024-06-01	600
105	U2	P3	2024-06-04	600
106	U2	P3	2024-06-08	600
107	U3	P1	2024-06-01	500
108	U3	P4	2024-06-02	900



---

ğŸ¯ Your Task:

Find the top 1 most frequently bought product for each user.

If a user has multiple products with the same frequency, return any one of them.


---

âœ… Expected Output:

user_id	product_id	total_orders

U1	P1	2
U2	P3	3
U3	P1	1



---

âš ï¸ Constraints:

Use CTEs and window functions

Donâ€™t use LIMIT â€” use RANK() or ROW_NUMBER()



---

Let me know:

Want to try it yourself? ğŸ”¥

Need a hint? ğŸ’¡

Want to validate your query line-by-line after writing? ğŸ§ 


Your move, analyst ğŸ§©

