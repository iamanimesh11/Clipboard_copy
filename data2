
select restaurant_id,avg(base_price) as avg_bp,
avg(dynamic_price)
as avg_dp,avg(final_price) as avg_fp,
(avg(dynamic_price)-avg(base_price))/avg(base_price) *100 as revenue_change,
case when (avg(dynamic_price)-avg(base_price))/avg(base_price) *100 >=10 then "BENEFICIAL"
WHEN (avg(dynamic_price)-avg(base_price))/avg(base_price) *100 <=10 then "lost revenue"
else "neutral" 
end as status
from orders 
group by restaurant_id





