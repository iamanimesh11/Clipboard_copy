Sub RemoveDuplicates_ActiveSheet_AutoHeader()
    Dim ws As Worksheet
    Dim lastRow As Long
    Dim lastCol As Long
    Dim colArray() As Long
    Dim i As Long
    Dim hasHeader As Boolean
    
    ' Use the active sheet
    Set ws = ActiveSheet
    
    ' Find last used row and column
    lastRow = ws.Cells(ws.Rows.Count, 1).End(xlUp).Row
    lastCol = ws.Cells(1, ws.Columns.Count).End(xlToLeft).Column
    
    ' Check if there is data to process
    If lastRow < 2 Or lastCol < 1 Then
        MsgBox "Not enough data to remove duplicates.", vbExclamation
        Exit Sub
    End If
    
    ' Determine if sheet has headers (simple check: first row is text)
    hasHeader = False
    For i = 1 To lastCol
        If Not IsNumeric(ws.Cells(1, i).Value) And ws.Cells(1, i).Value <> "" Then
            hasHeader = True
            Exit For
        End If
    Next i
    
    ' Create an array of all column numbers
    ReDim colArray(1 To lastCol)
    For i = 1 To lastCol
        colArray(i) = i
    Next i
    
    ' Remove duplicates
    ws.Range(ws.Cells(1, 1), ws.Cells(lastRow, lastCol)).RemoveDuplicates Columns:=colArray, Header:=IIf(hasHeader, xlYes, xlNo)
    
    MsgBox "Duplicates removed successfully!", vbInformation
End Sub