with timediff_dt  as (
select user_id,page_id,visit_time,
TIMESTAMPDIFF(MINUTE,
    lag(visit_time) over (partition by user_id order by visit_time),
    visit_time) as t 
from page_visits
)
select user_id,page_id,visit_time,t,
case when t >15 then 1 else 0
end as new_Session_flag
from timediff_dt
