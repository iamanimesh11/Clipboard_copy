
CREATE TEMP FUNCTION CALC_DISCOUNT(base_price NUMERIC ,discount FLOAT64) as (
final_price=base_price*(1-discount)
);


With products as (
SELECT 'LAPTOP' AS product_id,Numeric '1200.00' as base_price,0.10 as discount_pct UNION ALL
SELECT 'mouse' AS product_id,Numeric '25.50' as base_price,0.0 as discount_pct UNION ALL
SELECT 'keyboard' AS product_id,Numeric '79.99' as base_price,0.15 as discount_pct 
)
SELECT CALC_DISCOUNT(products.base_price,products.discount_pct)
FROM products 

