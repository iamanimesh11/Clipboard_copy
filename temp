SELECT
  fullVisitorId,
  visitStartTime,
  ARRAY(
    SELECT DISTINCT h.product.productName
    FROM UNNEST(hits) AS h
    WHERE h.type = 'TRANSACTION'
  ) AS product_names
FROM
  `bigquery-public-data.google_analytics_sample.ga_sessions_20170801`
LIMIT 100