from kafka.admin import KafkaAdminClient, NewTopic

def create_kafka_topic(topic_name, num_partitions, replication_factor):
    try:
        # Initialize KafkaAdminClient
        admin_client = KafkaAdminClient(
            bootstrap_servers="localhost:9092",  # Replace with your broker address
            client_id="kafka-topic-creator"
        )

        # Define the topic to be created
        topic = NewTopic(
            name=topic_name,
            num_partitions=num_partitions,
            replication_factor=replication_factor
        )

        # Create the topic
        admin_client.create_topics(new_topics=[topic], validate_only=False)
        print(f"Topic '{topic_name}' created successfully!")

    except Exception as e:
        print(f"Error creating topic: {e}")
    finally:
        admin_client.close()

if __name__ == "__main__":
    create_kafka_topic("new_topic", num_partitions=2, replication_factor=1)