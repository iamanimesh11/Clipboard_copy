select
     fullvisitorid,
     visitStartTime,
     totals.pageviews,
     sum(totals.pageviews) over (
        partition by fullVisitorId order by visitStartTime 
        ROWS BETWEEN 4 PRECEDING AND CURRENT ROW ) AS moving_pageviews_3_Sessions
     FROM `bigquery-public-data.google_analytics_sample.ga_sessions_*`
     WHERE  _TABLE_SUFFIX = '20170801' and  fullVisitorId is not Null and totals.pageviews>=4
LIMIT 100
